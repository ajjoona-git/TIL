## 로컬 환경에서 개발 시 체크리스트!

### git pull

작업 시작 전에 로컬 dev, feat 브랜치 최신화하기!!!

### 가상 환경 실행

가상 환경 활성화하고 패키지 최신화하기!

### 환경 변수 설정

.env 파일 업데이트하기!

### DB, 구글로그인 설정하기

settings를 local 환경과 배포 환경을 구분해놓았기 때문에, `--settings=config.settings.local`을 추가해준다.

```bash
python manage.py migrate --settings=config.settings.local
python manage.py apply_socialapp --settings=config.settings.local
python manage.py runserver --settings=config.settings.local
```

---

어제 문제인 줄 알았던 뒤로 가기 버튼 수정 코드는 잘 작동했다ㅎㅎ
배포 후에 새로고침을 할 때에는 꼭 세션을 지우고 새로고침하도록!

---

## 오늘 한 일

### #84 `feat/frontend-fix-button` - 메인 페이지 버튼의 비활성화 상태 초기화 로직 추가

**문제 상황 (오류)**

'길찾기 시작' 버튼을 눌러 경로 안내(스토리 카드)가 진행되는 화면에서 뒤로가기 버튼을 누르면, 이전 단계인 '역 검색' 화면으로 돌아가는 것이 아니라 메인 페이지로 이동하거나 앱이 종료되는 등 사용자의 의도와 다르게 동작했습니다.

- **원인**: `goBack()` 함수가 현재 앱의 상태(경로 안내 중)를 고려하지 않고, 단순히 브라우저의 방문 기록(`history.back()`)에만 의존했기 때문입니다.

**해결 방법**

`route.js`의 `goBack()` 함수에 조건문을 추가하여, 앱의 현재 상태를 먼저 확인하고 그에 맞는 동작을 하도록 수정했습니다.

```jsx
function goBack() {
    const routeGuidance = document.getElementById('routeGuidance');
    // 경로 안내 카드가 화면에 표시된 상태라면, 경로 안내 카드를 숨기고 다시 검색 화면으로 이동
    if (routeGuidance.style.display === 'block') {
        routeGuidance.style.display = 'none';
        document.querySelector('.input-section').style.display = 'block';
        document.getElementById('startStation').value = ''
        document.getElementById('endStation').value = ''
    }
    // 방문 기록이 있으면서, 동시에 외부 페이지를 통해 정상적으로 들어온 경우에만 뒤로가기
    else if (window.history.length > 1 && document.referrer) {
        window.history.back();
    }
    // 그렇지 않다면, 메인 페이지로 이동
    else {
        const mainPageUrl = appContainer.dataset.mainPageUrl;
        window.location.href = mainPageUrl;
    }
}
```

---

### #83 `feat/frontend-fix-button` - 경로 안내 카드 뒤로가기 버튼 수정

**문제 상황 (오류)**

메인 페이지에서 '길찾기' 또는 '역 정보' 버튼을 클릭하면 로딩 상태가 되면서 비활성화됩니다. 이후 다른 페이지로 이동했다가 브라우저의 '뒤로가기' 기능으로 다시 메인 페이지로 돌아오면, 버튼이 로딩 애니메이션은 사라졌지만 여전히 비활성화(`disabled`) 상태로 남아있어 클릭할 수 없었습니다.

- **원인**: 브라우저의 뒤로가기 캐시(bfcache) 기능이 페이지를 새로 로드하는 대신, 버튼이 비활성화된 이전 상태 그대로 복원했기 때문입니다.

**해결 방법**

`index.js` 파일에 `pageshow` 이벤트를 감지하는 리스너를 추가했습니다. 이 리스너는 사용자가 뒤로가기를 통해 페이지에 다시 방문할 때마다 버튼의 상태를 강제로 초기화합니다.

1. `btn.classList.remove('loading');`
    - 버튼의 **시각적 상태** (로딩 애니메이션)를 제거합니다.
2. `btn.disabled = false;`
    - 버튼의 **기능적 상태** (비활성화 속성)를 제거하여 다시 클릭할 수 있도록 만듭니다.

```jsx
function initializeMainPage() {
    // Add any initialization code here
    console.log('쉽길 메인페이지가 로드되었습니다.');

    // 페이지가 표시될 때마다 실행되는 이벤트 리스너
    window.addEventListener('pageshow', function(event) {
        // event.persisted가 true이면, 페이지가 bfcache에서 복원된 것입니다.
        if (event.persisted) {
            // 모든 메인 버튼을 찾습니다.
            const mainButtons = document.querySelectorAll('.main-btn');
            mainButtons.forEach(btn => {
                // 'loading' 클래스를 제거합니다.
                btn.classList.remove('loading');
                // 버튼의 비활성화 속성을 제거합니다.
                btn.disabled = false;
            });
        }
    });
}
```