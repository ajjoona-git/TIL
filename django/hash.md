## 비밀번호 암호화

> 참고: [안전한 패스워드 저장 | NAVER D2](https://d2.naver.com/helloworld/318732)
>

### 해시 (Hash)

임의의 크기를 가진 데이터를 고정된 크기의 고유한 값으로 변환하는 과정

- 눈사태 효과: 작은 변화에도 해시값이 크게 달라진다.

### 해시 함수

임의 길이 데이터를 입력받아 고정 길이(정수)로 변환해주는 함수

- 단방향: 입력값으로 해시값을 만들 수는 있지만, 해시값만 보고 원래 입력값을 알아낼 수 없다.
- 같은 입력 값을 넣으면 언제나 똑같은 해시 값이 나온다.
- django는 기본적으로 SHA-256 해시 함수를 사용해서 암호화한다.
    - **SHA-256** (Secure Hash Algorithm): 어떤 데이터를 입력해도 256비트 길이의 결과물을 만든다.

### 레인보우 테이블 공격

- 모든 해시값을 미리 계산해두는 방식의 공격

**방어법:** 솔트(Salt)

- 사용자의 해시값이 레인보우 테이블에 없도록 해시 값을 만들어서 방어한다.
- 비밀번호에 ‘**솔트(Salt)**’를 붙여서 해시 암호화를 진행한다.
    - 솔트(Salt): 각 사용자마다 고유하게 생성된 임의의 문자열
- 솔트는 해시값과 함께 데이터베이스에 저장된다.

→ 각 사용자마다 레인보우 테이블을 만들어야 하므로 공격의 효율성을 떨어뜨린다.

### 무차별 대입 공격 (Brute-force Attack)

- 가능한 모든 비밀번호를 하나씩 직접 대입해보는 공격 방법
- 컴퓨터의 빠른 연산 속도가 공격자의 무기가 되었다…
    - 최신 GPU는 초당 약 1,500억 번 이상 추측 가능

**방어법:** 키 스트레칭 (Key Stretching)

- 의도적으로 비밀번호 검증 과정을 느리게 만든다.
- 연산 속도를 늦추기 위함
- 사용자가 체감할 정도의 연산 속도는 아니다.
    - 1개당 0.2초로 바꾼다고 하면, 실제 공격자는 1초에 5번의 공격만 가능하다.
- 알고리즘 예시: PBKDF2, Argon2, bcrypt 등

### Django에서의 비밀번호 암호화

`<algorithm>$<iterations>$<salt>$<hash>`

- `<algorithm>`: 어떤 알고리즘을 쓰는지
- `<iterations>`: 키 스트레칭 횟수
- `<salt>`: 생성된 솔트
- `<hash>`: 생성된 최종 해시
- 예시:

```
pbkdf2_sha256$1000000$PiGVvmGrDtTeawu1V2ujY8$B+KZIasamvMPrtEdau5yGrhC0osOZClQ3ePm47lLifE=
```